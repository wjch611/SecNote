[TOC]

**企业查询：**

1. 爱企查：pdd超级会员账号1块7天
2. 小蓝本免费

**查根域名：**

1. ICP备案查询网站

**IP反查：**

1. 根据ip反查解析域名

**子域名查询：**

1. dnsdumpster.com，域名解析记录查询（**即使删了以前**的也能查到）

2. https证书查询：crt.sh（只针对https）

3. 网络空间

   1. fofa
   2. hunter
   3. quake

4. OneForAll

   结合：字典爆破、DNS查询、证书查询

**指纹识别：**（一般针对个人小网站，CMS开源）

拿到子域名之后，分析网站架构源码

1. tidefinger.com
2. 云溪指纹
3. gotoscan项目-解决内网识别不到

**尝试源码获取：**

1. CMS，指纹识别
2. 闭源：管理员/开发者习惯不好
   1. 备份源代码压缩包放在源码目录下
   2. .git/svn泄露，工具：git/svnhack
   3. DS_Store，MAC开发泄露
   4. composer.json文件泄露，针对php网站
   5. 码云泄露，抓包找特殊的js文件特征搜

**JS泄露：**

一般使用JS框架的存在JS泄露比较多，与传统区别在与数据传输使用的是框架API，而不是后端语言（分析插件：wapplayer）

**应用服务器与web服务器：**

1. web：apache、nginx、iis
2. 应用服务器：tomcat、jboss，除了网站服务端口，**自身程序还会再开一个端口**

**端口扫描：**

主动：Nmap、Masscan(c语言写)

被动：空间搜索

目的：明确服务器开开放的服务

**扫不到情况：**

1. CDN、负载均衡、内网、反向代理...，防火墙

**WAF分类：**

1. 云WAF：阿里云盾、长亭雷池....
2. 硬件WAF：绿盟、安恒...
3. 软件WAF：宝塔、安全狗、D盾

其中最贵，最安全的是云WAF，最后是软件WAF

针对绕过，软件WAF还可一试

**蜜罐识别：**（红蓝对抗知识）

1. 浏览器插件：heimdallr（准确率不高）
2. quake_rs，需要积分
3. 人工判断
   1. 端口多，有规律
   2. web去访问非http协议出现下载

**CDN：**

内容分发服务，国内CDN服务需要备案域名

对渗透测试的影响：**隐藏真实IP**

识别：超级ping，直接**ping主域名**

**CDN配置与绕过：**

```
 1. 没有配置*.example.com，全域名加速
 1. 没有配置全球加速
 1. 没有配置全站加速
```

其他手段：

1. HOST碰撞

2. 让对方发邮件

   原因：MX记录不能配置CDN，主动出来找自己

   判断：发件人是不是第三方

3. 发送邮件给对方

   原因：发送一个对方邮件服务器不存在的邮件地址，对方服务器会退回，并且放回对方IP

   要求：需要使用**自己的邮件服务器**发送

4. get-site-ip平台（不准确）

结合ip地址，域名注册/备案，综合判断

**IP<->地区/云厂商：**

1. ip查地区/云厂商：ipip.net
2. 地区/云厂商查ip库：纯真IP地址数据库

**fuckcdn-master：**全网扫项目

1. 确定云厂商
2. 云厂商ip库查询
3. 输入网站特征信息

**CMS识别主要针对PHP**

**后端框架识别：**前端有JS框架

目的：源码安全性取决于框架安全性，框架有漏洞源码就有漏洞

1. phthon框架：Django、Flask

2. php框架：Thinkphp、Laravel、Yii

3. java框架

   识别方法：

   1. 浏览器插件
   2. 数据包：**set-cookies**关键字

**后端组件/中间件识别：**

JAVA组件：Log4j2、shiro、spring boot、fastjson。。。

识别：数据包判断、图标...

**查找NDAY：**

漏洞情报

------

**APP查找：**

1. 点点、七麦
2. 小蓝本、爱企查、企查查

**APP信息提取：**目的是提取信息，后续测试，而不是逆向破解

1. 抓包-动态

2. 提取-动态调试（能提取到一些抓包抓不到的）

   工具：mobsf+模拟器（反抓包、反代理）

------

**小程序信息提取：**

1. 解包，反编译（工具收费），获取源码，查找未授权/信息泄露
2. 抓包

------

**Asamf:**

一体化网络科技免费导出爬虫项目

**ENScan:**

一体化企业信息收集项目

**自动化信息收集工具：**

都需要配置在vps上

```
 1. Nemo
 2. 灯塔
```

------

**微信公众号信息收集：**

目的：获取第三方服务信息

**github持续监控信息泄露项目**：实时掌握最新信息

```
 1. Gshark
 1. github monitor
```

**空间搜索进阶：**

1. 证书搜索
2. 图标搜索
3. 邮箱搜索

### 重要：

1. APP动态调试工具：mobsf
2. 小程序反编译工具
3. github持续监控项目：Gshark、github monitor

## 子域名收集：

#### 一、自动化适用范围

#### 1. 泛Scope

如果是*.example.com，那就需要，如果直接是example.com就不需要！！！

#### 2. 分配站除外

比如slack，xxx.slack.com，xxx就是一个工作空间，不存在的xxx访问就是404

#### 二、自动化步骤

#### 1. 被动收集

1. subfinder 全面的被动收集工具
2. ctfr 针对 证书收集的工具
   1. 挑出带*的放到一边（如果有需要给到ffuf subdomain)
3. 1+2去重
4. httpx 去除没有http服务的
5. 去掉https://

#### 2. 主动爆破

1. ffuf domain -> -mc all 存在http服务的都留下
2. 提取出域名
3. 和被动收集的合并去重

#### 三、手动空间搜索

1. 得到1,2的去重+存活的所有域名
2. 手动空间搜索 + cy + ctrl+f，存在的就丢

### 自动化工具集成：FFsubdomain.py

[wjch611/FFsubfinder: ffsubfinder 是一个集成 被动子域名枚举、HTTP 存活探测以及 FFUF 子域名猜解的 Python 自动化脚本。它能够批量处理域名列表，对每个域名执行子域名发现、存活验证、fuzz 发现，并最终合并去重有效子域名。](https://github.com/wjch611/FFsubfinder)