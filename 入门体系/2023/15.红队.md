[TOC]

## 一、钓鱼

### 一、邮件钓鱼

步骤：

1. 取得信任/伪造发件人
2. 转到网站钓鱼
3. 转到附件钓鱼

项目gophish：

1. 批量发送
2. 支持结合自己搭建的邮箱服务器作为中转，绕过SPN
3. 内容模板

#### 一、取得信任

原理：

	伪造那些大众认知安全的邮箱账号作为发件人

方法：

1. 判断对方的邮箱系统是否采用了SPF认证

   ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/99ebffe3657843f4af2f2b806253053c.png#pic_center)


2. 没有采用，直接伪造套用

3. 采用了

   1. 使用类似字眼的邮箱
   2. 借用一个邮箱服务器作为中转代发
      1. 但是对方会发现有代发字眼
      2. 所以这个邮箱服务器最好直接搭建，然后解析申请一个可信度高的域名（最好在国外购买服务器，开放25端口的smtp）

#### 二、邮件->网站钓鱼

原理：

	中邮件内容中添加网址，域名指向伪域名（申请一个类白名单域名），架设服务器，搭建钓鱼网站，内容需要和真域名的网站相同

危害：

1. 获取敏感信息
2. 诱使下载后门

手法：

1. 使用钓鱼网站拉取工具，拉取目标网站，然后架设在自己服务器上
   1. 缺点：
      1. 加密登陆还需要JS逆向
      2. 二维码登陆等复杂情况干不了
2. 自己制作钓鱼网站，到目标网站，右键复制，然后修改源码
   1. 优点：
      1. 针对加密的，在加密前就获取，发送
      2. 针对二维码登陆的，将自己目标的二维码异步到钓鱼网站上

#### 三、邮件->附件钓鱼

##### 文档类型：	

	office和wps office家族

###### 手法：

1. 宏
2. CVE打

###### 宏执行/加载后门：

1. 在office和wps office中，各种类型的文档都能支持宏，打开文档，执行宏，c2有宏形式的shellcode，植入
2. 也可以在普通文档中指定远程加载带有后门宏的模板

适用范围：(office为例)

1. doc、docm、dot、dotm
2. xls、xlsm、xlt、xltm
3. ppt、pptm、pot、potm
4. 后门两个都是模板

条件：

1. 免杀问题
2. 默认不打开宏，都需要诱使对方，手动开启宏

##### 电子书类型：chm后缀

1. 找到一个正常的chm电子书
2. 在源码里面插入加载后门的代码

##### 压缩包类型：

1. 利用win的RLO功能，将exe后缀搞成zip后缀，图像搞成压缩包图像
2. 自解压+RLO
   1. 自解压的会目标程序打包在一起成为一个exe，对方在执行这个exe就会自动解压不需要解压工具
   2. 将后门和另外一个可执行程序打包成自解压exe，然后使用RLO，改为ZIP后缀

##### 捆绑正常程序+后门程序：

原理：

	直接放一个c2的可执行程序，你说它是某某软件，即使别人相信了，执行之后也会发现不对。所以需要将后门和某某软件捆绑，这样，它就不会发觉了。

注意：

	需要挑选合适的白名单的捆绑程序，最好是系统自带的。

### 二、近源钓鱼

##### wifi中间人：

	需要一个网卡，提供wifi热点，别人连接就能获取他的流量

##### BadUsb：

	需要一个没有驱动的usb，使用ide在里面植入后门程序，插入即运行

---

## 二、反溯源

	目的是为了让蓝队不能通过C2后门直接找到CS服务器所在的ip

#### CDN:

1. CS所在VPS，解析一个域名，配置CDN
2. 生成后门，连接目标设为
   1. 域名
   2. 多个节点ip

#### 云函数：

原理：

	是各大云厂商，提供的一个接口，配置之后这个接口对应一个自己的公网ip，那么以后访问这个提供接口的域名，就是访问自己的公网ip。

步骤：

1. 去云厂商申请一个接口，给上自己的ip，服务端口，获取到接口域名
2. 生成后门，连接目标设为，接口域名

#### 中间vps端口转发：

原理：

	在CS的vps和目标之间设置一个中间vps，配置这个vps将端口A的流量转给CS的vps端口B，生成后门去连接中间VPS的端口A

#### CS服务器反向代理中间VPS：

步骤：

1. 在中间VPS上搭建网站，并且设置反向代理为CS的服务器
2. 后门连接中间VPS，访问到CS服务端

## 三、反IP拉黑

1. 购买代理池，使用隧道代理，每次访问都改变IP
2. 使用Clash，配置，每次访问都改变IP